# ü§ñ AMG Auto Trade Telegram Bot

–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram –±–æ—Ç –¥–ª—è –ø—Ä–∏–µ–º–∞ –∑–∞—è–≤–æ–∫ —Å —Å–∞–π—Ç–∞ amgautotrade.ru

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì• **–ü—Ä–∏–µ–º –∑–∞—è–≤–æ–∫ —Å —Å–∞–π—Ç–∞** —á–µ—Ä–µ–∑ REST API
- üì§ **–ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –≤—Å–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º
- ü§ñ **–ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** (/start, /help, /status, /stats, /chatid)
- üí¨ **–ê–≤—Ç–æ–æ—Ç–≤–µ—Ç—ã** –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üìù **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- üîÑ **–ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** –ø—Ä–∏ —Å–±–æ—è—Ö
- üåê **Webhook –∏–ª–∏ Polling** —Ä–µ–∂–∏–º

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ:

```bash
cp .env.example .env
nano .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
- `BOT_TOKEN` - —Ç–æ–∫–µ–Ω –æ—Ç @BotFather
- `MANAGER_CHAT_IDS` - –≤–∞—à Chat ID (—É–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥–æ–π /chatid)
- `API_SECRET` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è API

### 3. –ó–∞–ø—É—Å–∫

**–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞:**
```bash
npm run dev
```

**–ü—Ä–æ–¥–∞–∫—à–µ–Ω (PM2):**
```bash
npm run pm2:start
```

**–ü—Ä–æ–¥–∞–∫—à–µ–Ω (systemd):**
```bash
# –°–º. VPS_DEPLOY.md
```

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º |
| `/status` | –°—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ |
| `/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫ |
| `/chatid` | –ü–æ–ª—É—á–∏—Ç—å –≤–∞—à Chat ID |

## üîå API Endpoints

### POST /api/lead

–ü—Ä–∏–µ–º –∑–∞—è–≤–∫–∏ —Å —Å–∞–π—Ç–∞.

**Request:**
```json
{
  "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
  "phone": "+7 (985) 674-26-50",
  "message": "–ò–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç BMW X5",
  "source": "–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",
  "car": "BMW X5 2023",
  "secret": "–≤–∞—à_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á"
}
```

**Response:**
```json
{
  "success": true,
  "message": "Lead received",
  "sent_to": 2
}
```

### GET /health

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.

**Response:**
```json
{
  "status": "ok",
  "uptime": 12345,
  "mode": "polling",
  "timestamp": "2025-12-24T12:00:00.000Z"
}
```

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
telegram-bot/
‚îú‚îÄ‚îÄ bot.js              # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îú‚îÄ‚îÄ package.json        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example        # –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îú‚îÄ‚îÄ ecosystem.config.js # PM2 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ amg-bot.service     # Systemd service
‚îú‚îÄ‚îÄ VPS_DEPLOY.md       # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
‚îú‚îÄ‚îÄ README.md           # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ .gitignore
```

## üîß –°–∫—Ä–∏–ø—Ç—ã

```bash
npm start           # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
npm run dev         # –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å nodemon
npm run pm2:start   # –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PM2
npm run pm2:stop    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2
npm run pm2:restart # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ PM2
npm run pm2:logs    # –õ–æ–≥–∏ PM2
npm run pm2:monit   # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PM2
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**PM2:**
```bash
pm2 monit
pm2 logs amg-bot
pm2 list
```

**–õ–æ–≥–∏ –±–æ—Ç–∞:**
```bash
tail -f bot.log
```

**Systemd:**
```bash
systemctl status amg-bot
journalctl -u amg-bot -f
```

## üåê –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### Polling (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

–ü—Ä–æ—Å—Ç–æ–π —Ä–µ–∂–∏–º, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ. –ë–æ—Ç —Å–∞–º –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç Telegram API.

```env
MODE=polling
```

### Webhook (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

–¢—Ä–µ–±—É–µ—Ç –¥–æ–º–µ–Ω –∏ SSL. Telegram —Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä.

```env
MODE=webhook
WEBHOOK_URL=https://bot.amgautotrade.ru
WEBHOOK_PORT=3000
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env` –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` –≤ git
- ‚úÖ –°–º–µ–Ω–∏—Ç–µ `API_SECRET` –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è webhook
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `bot.log`:

```
[2025-12-24T12:00:00.000Z] ‚úì Bot started successfully
[2025-12-24T12:05:30.123Z] ‚úì New lead: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ - +7 (985) 674-26-50
[2025-12-24T12:10:15.456Z] ‚úì Command /status from 123456789
```

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [VPS_DEPLOY.md](VPS_DEPLOY.md) - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ VPS
- [node-telegram-bot-api](https://github.com/yagop/node-telegram-bot-api) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

**–ü—Ä–æ–±–ª–µ–º—ã?**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `pm2 logs amg-bot` –∏–ª–∏ `tail -f bot.log`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `/status` –≤ –±–æ—Ç–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: `cat .env`

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

AMG Auto Trade

---

**–°–æ–∑–¥–∞–Ω–æ:** 2025-12-24
**–í–µ—Ä—Å–∏—è:** 1.0.0
